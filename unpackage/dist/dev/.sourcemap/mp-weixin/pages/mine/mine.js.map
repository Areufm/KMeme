{"version":3,"file":"mine.js","sources":["pages/mine/mine.vue","D:/Software/HBuilder/HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbWluZS9taW5lLnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"content\">\n\t\t<view class=\"topBox\">\r\n\t\t\t<view class=\"setBox\">\r\n\t\t\t\t<view class=\"set-left\">\r\n\t\t\t\t\t<uni-icons type=\"caledar\" size=\"30\" color=\"#ffffff\"></uni-icons>\r\n\t\t\t\t\t<view class=\"txt\">签到</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"set-right\">\r\n\t\t\t\t\t<uni-icons type=\"gear\" size=\"30\" color=\"#ffffff\"></uni-icons>\r\n\t\t\t\t\t<uni-icons type=\"chat\" size=\"30\" color=\"#ffffff\"></uni-icons>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"users\">\r\n\t\t\t\t<view class=\"u-top\" @click=\"setFun\">\r\n\t\t\t\t\t<template v-if=\"!userInfo.nickName\">\r\n\t\t\t\t\t\t<image \r\n\t\t\t\t\t\t\tsrc=\"/static/catcats.jpg\"\r\n\t\t\t\t\t\t\tmode=\"aspectFill\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t</image>\r\n\t\t\t\t\t\t<view class=\"tit\">\r\n\t\t\t\t\t\t\t 注册 / 登录\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t<image\r\n\t\t\t\t\t\t\t:src=\"userInfo.avatarUrl\"\r\n\t\t\t\t\t\t\tmode=\"aspectFill\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t</image>\r\n\t\t\t\t\t\t<view class=\"tit\">\r\n\t\t\t\t\t\t\t {{ userInfo.nickName }}\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"u-bottom\">\r\n\t\t\t\t\t<view class=\"u-item\">\r\n\t\t\t\t\t\t<view class=\"num\">12</view>\r\n\t\t\t\t\t\t<view class=\"u-tit\">点赞</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"u-item\">\r\n\t\t\t\t\t\t<view class=\"num\">12</view>\r\n\t\t\t\t\t\t<view class=\"u-tit\">喜欢</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"u-item\">\r\n\t\t\t\t\t\t<view class=\"num\">12</view>\r\n\t\t\t\t\t\t<view class=\"u-tit\">浏览</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"u-item\">\r\n\t\t\t\t\t\t<view class=\"num\">12</view>\r\n\t\t\t\t\t\t<view class=\"u-tit\">收藏</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\n\t\t<view class=\"listBox\">\r\n\t\t    <view class=\"section\">\r\n\t\t\t\t<view class=\"list\">\r\n\t\t\t\t\t<view class=\"row\" @click=\"goToProfile\">\r\n\t\t\t\t\t\t<view class=\"left\">\r\n\t\t\t\t\t\t\t<uni-icons type=\"person-filled\" size=\"20\"></uni-icons>\r\n\t\t\t\t\t\t\t<view class=\"text\">我的信息</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"row\">\r\n\t\t\t\t\t\t<view class=\"left\">\r\n\t\t\t\t\t\t\t<uni-icons type=\"chatboxes-filled\" size=\"20\"></uni-icons>\r\n\t\t\t\t\t\t\t<view class=\"text\">用户反馈</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"row\">\r\n\t\t\t\t\t\t<view class=\"left\">\r\n\t\t\t\t\t\t\t<uni-icons type=\"link\" size=\"20\"></uni-icons>\r\n\t\t\t\t\t\t\t\t<view class=\"text\">项目地址</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"row\">\r\n\t\t\t\t\t\t<view class=\"left\">\r\n\t\t\t\t\t\t\t<uni-icons type=\"info\" size=\"20\"></uni-icons>\r\n\t\t\t\t\t\t\t<view class=\"text\">关于我们</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<up-popup closeable @click=\"close\" :show=\"show\" round=\"20\">\r\n\t\t\t<view class=\"popup\">\r\n\t\t\t\t<view class=\"title\">获取您的昵称、头像</view>\r\n\t\t\t\t<view class=\"flex\">\r\n\t\t\t\t\t<view class=\"label\">获取用户头像</view>\r\n\t\t\t\t\t<button class=\"avatar-warpper\" open-type=\"chooseAvatar\" @chooseavatar=\"onChooseavatar\">\r\n\t\t\t\t\t\t<image class=\"avatar\" :src=\"userInfo.avatarUrl\"></image>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"flex\">\r\n\t\t\t\t\t<view class=\"label\">获取用户昵称：</view>\r\n\t\t\t\t\t<input @input=\"changeName\" type=\"nickname\">\r\n\t\t\t\t</view>\r\n\t\t\t\t<button size=\"default\" type=\"primary\" @click=\"userSubmit\">确定</button>\r\n\t\t\t</view>\r\n\t\t</up-popup>\n\t</view>\n</template>\n\n<script setup>\nimport {ref, reactive} from 'vue'\r\nimport { onLoad } from '@dcloudio/uni-app'\r\nimport { login, getUserInfo} from '../../api/api.js'\r\n\r\nonLoad(async () => {\r\n\t// 免登录\r\n\tif(uni.getStorageSync('token') && !uni.getStorageSync('userInfo')) {\r\n\t\tconst { avatarUrl, nickName } = await getUserInfo()\r\n\t\tuserInfo.avatarUrl = avatarUrl\r\n\t\tuserInfo.nickName = nickName\r\n\t} else if(uni.getStorageSync('token') && uni.getStorageSync('userInfo')) {\r\n\t\tconst { avatarUrl, nickName } = JSON.parse(uni.getStorageSync('userInfo'))\r\n\t\tuserInfo.avatarUrl = avatarUrl\r\n\t\tuserInfo.nickName = nickName\r\n\t}\r\n})\r\n\r\nconst userInfo = reactive({\r\n\tnickName: '',\r\n\tavatarUrl: ''\r\n})\r\n\r\n// 弹出层显示\r\nconst show = ref(false)\r\n\r\nconst close = () => {\r\n\tshow.value = false\r\n}\r\n\r\nconst userSubmit = () => {\r\n\tuni.setStorageSync('userInfo', JSON.stringify(userInfo))\r\n\tshow.value = false\r\n\t\r\n}\r\n\r\nconst goToProfile = () => {\n\tuni.navigateTo({ \r\n\t\turl: '/pages/profile/profile',\r\n\t})\n}\r\n\r\nconst onChooseavatar = (e) => {\r\n\tuserInfo.avatarUrl = e.detail.avatarUrl\r\n}\r\nconst changeName = (e) => {\r\n\tuserInfo.nickName = e.detail.value\r\n}\r\n\r\nconst setFun = () => {\r\n\t// 给用户确认提醒\r\n\tuni.showModal({\r\n\t\ttitle: 'Ciallo～ (∠・ω< )⌒★',\r\n\t\tcontent: ' 授权微信登录后才能正常使用小程序喵',\r\n\t\tsuccess(res) {\r\n\t\t\tif (res.confirm) {\r\n\t\t\t\tconsole.log(\"确认登录\")\r\n\t\t\t\tuni.login({\r\n\t\t\t\t\tsuccess: async (data) => {\r\n\t\t\t\t\t\tconsole.log(data)\r\n\t\t\t\t\t\t// 通过code传给后端，后端去换取sessionKey\r\n\t\t\t\t\t\tconst{ token } = await login(data.code)\r\n\t\t\t\t\t\tconsole.log(token, 'token')\r\n\t\t\t\t\t\tuni.setStorageSync('token', token)\r\n\t\t\t\t\t\t// 通过token获取用户信息\r\n\t\t\t\t\t\tconst userData = await getUserInfo()\r\n\t\t\t\t\t\t// 把用户信息显示到页面\r\n\t\t\t\t\t\tuserInfo.avatarUrl = userData.avatarUrl\r\n\t\t\t\t\t\tuserInfo.nickName = userData.nickName\r\n\t\t\t\t\t\tshow.value = true \r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail(err) {\r\n\t\t\t\t\t\tconsole.error('uni.login调用失败:', err)\r\n\t\t\t\t\t\tuni.showToast({ title: '登录失败，请重试', icon: 'error' })\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n}\n</script>\n\n<style lang=\"scss\" scoped>\r\n.content {\r\n\theight: 100vh;\r\n\tbackground-color: #f5f5f5;\r\n\t.topBox {\r\n\t\twidth: 100%;\r\n\t\tposition: relative;\r\n\t\tz-index: 1;\r\n\t\toverflow: hidden;\r\n\t\tpadding: 40rpx 20rpx 40rpx;\r\n\t\tbox-sizing: border-box;\r\n\t}\r\n\t.topBox::after {\r\n\t\tcontent: \"\";\r\n\t\twidth: 140%;\r\n\t\theight: 200px;\r\n\t\tposition: absolute;\r\n\t\tz-index: -1;\r\n\t\ttop: 0;\r\n\t\tleft: -20%;\r\n\t\tbackground-color: #005588;\r\n\t\tborder-radius: 0 0 50% 50%;\r\n\t}\r\n\t.setBox {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\t.set-left {\r\n\t\t\twidth: 18%;\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: space-between;\r\n\t\t\talign-items: center;\r\n\t\t}\r\n\t\t.txt {\r\n\t\t\tcolor: #fff;\r\n\t\t\tfont-size: 30rpx;\r\n\t\t}\r\n\t}\r\n\t.users {\r\n\t\tmargin-top: 35rpx;\r\n\t\tpadding: 30rpx;\r\n\t\tbox-sizing: border-box;\r\n\t\theight: 280rpx;\r\n\t\tbackground-color: #fff;\r\n\t\tbox-shadow: 1px 10rpx 20rpx #aceace;\r\n\t\tborder-radius: 16rpx;\r\n\t\t.u-top {\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: flex-start;\r\n\t\t\talign-items: center;\r\n\t\t\tmargin-bottom: 30rpx;\r\n\t\t\timage {\r\n\t\t\t\twidth: 100rpx;\r\n\t\t\t\theight: 100rpx;\r\n\t\t\t\tborder-radius: 50%;\r\n\t\t\t\tmargin-right: 20rpx;\r\n\t\t\t}\r\n\t\t\t.tit {\r\n\t\t\t\tfont-size: 30rpx;\r\n\t\t\t\tfont-weight: 700;\r\n\t\t\t\tcolor: #333;\r\n\t\t\t}\r\n\t\t}\r\n\t\t.u-bottom {\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: space-around;\r\n\t\t\talign-items: center;\r\n\t\t\t.u-item {\r\n\t\t\t\ttext-align: center;\r\n\t\t\t\t.u-tit {\r\n\t\t\t\t\tcolor: #757575;\r\n\t\t\t\t\tfont-size: 26rpx;\r\n\t\t\t\t\tmargin-top: 10rpx;\r\n\t\t\t\t}\r\n\t\t\t\t.num {\r\n\t\t\t\t\tcolor: #000;\r\n\t\t\t\t\tfont-size: 33rpx;\r\n\t\t\t\t\tfont-weight: 700;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t.listBox {\r\n\t\tpadding: 20rpx;\r\n\t\t.section {\r\n\t\t\tbackground-color: #fff;\r\n\t\t\tborder-radius: 16rpx;\r\n\t\t\tpadding: 20rpx;\r\n\t\t\tmargin-bottom: 20rpx;\r\n\t\t\t.list {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\t.row {\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t\tpadding: 20rpx 0;\r\n\t\t\t\t\tborder-bottom: 1px solid #eee;\r\n\t\t\t\t\t&:last-child {\r\n\t\t\t\t\t\tborder-bottom: none;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t.left {\r\n\t\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\t\talign-items: center;\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t.text {\r\n\t\t\t\t\t\t\tmargin-left: 20rpx;\r\n\t\t\t\t\t\t\tfont-size: 30rpx;\r\n\t\t\t\t\t\t\tcolor: #333;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t.popup {\r\n\t\tpadding: 20rpx;\r\n\t\tborder-radius: 20rpx 20rpx 0 0;\r\n\t\t.title {\r\n\t\t\tmargin-bottom: 20rpx;\r\n\t\t\tfont-size: 40rpx;\r\n\t\t\ttext-align: center;\r\n\t\t}\r\n\t\t.flex {\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: flex-start;\r\n\t\t\talign-items: center;\r\n\t\t\tborder-bottom: 1px solid #f5f5f5;\r\n\t\t\tpadding: 24rpx 0;\r\n\t\t}\r\n\t\timage {\r\n\t\t\twidth: 70rpx;\r\n\t\t\theight: 70rpx;\r\n\t\t}\r\n\t\t.avatar-warpper {\r\n\t\t\tborder: none;\r\n\t\t\tborder-radius: 10rpx;\r\n\t\t\twidth: 70rpx;\r\n\t\t\theight: 70rpx;\r\n\t\t\tmargin-left: 20rpx;\r\n\t\t\tpadding: 0;\r\n\t\t}\r\n\t}\r\n}\n</style>\n","import MiniProgramPage from 'E:/Projects/Software/KMeme/KMeme/pages/mine/mine.vue'\nwx.createPage(MiniProgramPage)"],"names":["onLoad","uni","getUserInfo","reactive","ref","login"],"mappings":";;;;;;;;;;;;;;;;;AA8GAA,kBAAAA,OAAO,YAAY;AAElB,UAAGC,cAAAA,MAAI,eAAe,OAAO,KAAK,CAACA,oBAAI,eAAe,UAAU,GAAG;AAClE,cAAM,EAAE,WAAW,SAAU,IAAG,MAAMC,QAAAA,YAAa;AACnD,iBAAS,YAAY;AACrB,iBAAS,WAAW;AAAA,MACtB,WAAWD,cAAG,MAAC,eAAe,OAAO,KAAKA,oBAAI,eAAe,UAAU,GAAG;AACxE,cAAM,EAAE,WAAW,aAAa,KAAK,MAAMA,cAAG,MAAC,eAAe,UAAU,CAAC;AACzE,iBAAS,YAAY;AACrB,iBAAS,WAAW;AAAA,MACpB;AAAA,IACF,CAAC;AAED,UAAM,WAAWE,cAAAA,SAAS;AAAA,MACzB,UAAU;AAAA,MACV,WAAW;AAAA,IACZ,CAAC;AAGD,UAAM,OAAOC,cAAG,IAAC,KAAK;AAEtB,UAAM,QAAQ,MAAM;AACnB,WAAK,QAAQ;AAAA,IACd;AAEA,UAAM,aAAa,MAAM;AACxBH,oBAAG,MAAC,eAAe,YAAY,KAAK,UAAU,QAAQ,CAAC;AACvD,WAAK,QAAQ;AAAA,IAEd;AAEA,UAAM,cAAc,MAAM;AACzBA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,MACP,CAAE;AAAA,IACF;AAEA,UAAM,iBAAiB,CAAC,MAAM;AAC7B,eAAS,YAAY,EAAE,OAAO;AAAA,IAC/B;AACA,UAAM,aAAa,CAAC,MAAM;AACzB,eAAS,WAAW,EAAE,OAAO;AAAA,IAC9B;AAEA,UAAM,SAAS,MAAM;AAEpBA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,SAAS;AAAA,QACT,QAAQ,KAAK;AACZ,cAAI,IAAI,SAAS;AAChBA,0BAAAA,MAAY,MAAA,OAAA,8BAAA,MAAM;AAClBA,0BAAAA,MAAI,MAAM;AAAA,cACT,SAAS,OAAO,SAAS;AACxBA,8BAAAA,MAAY,MAAA,OAAA,8BAAA,IAAI;AAEhB,sBAAK,EAAE,MAAO,IAAG,MAAMI,QAAAA,MAAM,KAAK,IAAI;AACtCJ,8BAAAA,MAAY,MAAA,OAAA,8BAAA,OAAO,OAAO;AAC1BA,oCAAI,eAAe,SAAS,KAAK;AAEjC,sBAAM,WAAW,MAAMC,oBAAa;AAEpC,yBAAS,YAAY,SAAS;AAC9B,yBAAS,WAAW,SAAS;AAC7B,qBAAK,QAAQ;AAAA,cACb;AAAA,cACD,KAAK,KAAK;AACTD,8BAAAA,MAAA,MAAA,SAAA,8BAAc,kBAAkB,GAAG;AACnCA,8BAAG,MAAC,UAAU,EAAE,OAAO,YAAY,MAAM,SAAS;AAAA,cAClD;AAAA,YACN,CAAK;AAAA,UACD;AAAA,QACD;AAAA,MACH,CAAE;AAAA,IACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvLA,GAAG,WAAW,eAAe;"}